"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setupCacheCreations = void 0;
const setupCacheEdits_js_1 = require("./setupCacheEdits.js");
function setupCacheCreations(bot) {
    const { GUILD_CREATE, GUILD_LOADED_DD, GUILD_MEMBERS_CHUNK } = bot.handlers;
    bot.handlers.GUILD_CREATE = function (_, data, shardId) {
        // handle it as unavailable cuz we dont know what we're really getting
        const payload = data.d;
        const id = bot.transformers.snowflake(payload.id);
        // add guild to unavailable Set if its unavailable
        if (payload.unavailable)
            setupCacheEdits_js_1.unavailablesGuilds.add(id);
        GUILD_CREATE(bot, data, shardId);
    };
    bot.handlers.GUILD_LOADED_DD = function (_, data, shardId) {
        const payload = data.d;
        bot.transformers.guild(bot, {
            guild: payload,
            shardId,
        });
        GUILD_LOADED_DD(bot, data, shardId);
    };
    bot.handlers.GUILD_MEMBERS_CHUNK = function (_, data, shardId) {
        const payload = data.d;
        payload.members.forEach((member) => {
            bot.transformers.member(bot, member, BigInt(payload.guild_id), BigInt(member.user.id));
        });
    };
}
exports.setupCacheCreations = setupCacheCreations;
